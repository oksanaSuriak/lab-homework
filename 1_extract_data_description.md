# üìÑ 1_extract_data_description.md

##  –û–ø–∏—Å –ª–æ–≥—ñ–∫–∏ –≤–∏–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–∏—Ö –∑ Yahoo Finance

### –ú–µ—Ç–∞

–û—Ç—Ä–∏–º–∞—Ç–∏ —ñ—Å—Ç–æ—Ä–∏—á–Ω—ñ —Ç–∞ —â–æ–¥–µ–Ω–Ω—ñ –±—ñ—Ä–∂–æ–≤—ñ –¥–∞–Ω—ñ –ø—Ä–æ —Ü—ñ–Ω–∏ –∞–∫—Ü—ñ–π –æ–±—Ä–∞–Ω–∏—Ö –∫–æ–º–ø–∞–Ω—ñ–π –∑ Yahoo Finance, —É —Ñ–æ—Ä–º–∞—Ç—ñ, –ø—Ä–∏–¥–∞—Ç–Ω–æ–º—É –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó –æ–±—Ä–æ–±–∫–∏ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.

---

## –°–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω—ñ–π (tickers)

```
| Ticker | Company                  |
|--------|--------------------------|
| META   | Meta Platforms, Inc.     |
| AAPL   | Apple Inc.               |
| GOOG   | Alphabet Inc.            |
| TSLA   | Tesla, Inc.              |
| AMZN   | Amazon.com, Inc.         |
| MSFT   | Microsoft Corporation    |
| NVDA   | NVIDIA Corporation       |



```

–¶–µ ‚Äî —Å–ø–∏—Å–æ–∫ –Ω–∞–π–±—ñ–ª—å—à–∏—Ö –ø—É–±–ª—ñ—á–Ω–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏—Ö –∫–æ–º–ø–∞–Ω—ñ–π, –¥–∞–Ω—ñ —è–∫–∏—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è —â–æ–¥–µ–Ω–Ω–æ.

---

## –ü–µ—Ä—ñ–æ–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

–ö–æ–¥ —Ä–µ–∞–ª—ñ–∑—É—î **—ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —É–º–æ–≤–Ω–æ–≥–æ –±–ª–æ–∫—É:

```
if today_date > fixed_end_date:
    # –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
else:
    # –ü–æ–≤–Ω–µ —ñ—Å—Ç–æ—Ä–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
```

- **–Ü—Å—Ç–æ—Ä–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:**

  - –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –¥–æ –ø–µ–≤–Ω–æ—ó —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –¥–∞—Ç–∏ (`fixed_end_date = "2025-06-10"`).
  - –û—Ö–æ–ø–ª—é—î –ø–µ—Ä—ñ–æ–¥ –∑ `2020-01-01` –¥–æ `2025-06-10`.
  - –î–∞–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É —Ñ–∞–π–ª—ñ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.

- **–Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:**
  - –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, —è–∫—â–æ —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—è –¥–∞—Ç–∞ –ø–µ—Ä–µ–≤–∏—â—É—î `fixed_end_date`.
  - –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ç—ñ–ª—å–∫–∏ **–¥–∞–Ω—ñ –∑–∞ –≤—á–æ—Ä–∞—à–Ω—ñ–π –¥–µ–Ω—å** (`start=yesterday_date`, `end=today_date`).
  - –î–∞–Ω—ñ –¥–æ–¥–∞—é—Ç—å—Å—è —É CSV –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—é–≤–∞–Ω–Ω—è —Å—Ö–µ–º.

---

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è API –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ `yfinance`:

```
data = yf.download(tickers, start=..., end=..., group_by="ticker")
```

- –î–∞–Ω—ñ –≥—Ä—É–ø—É—é—Ç—å—Å—è –ø–æ —Ç–∏–∫–µ—Ä–∞—Ö.
- –ö–æ–∂–Ω–∞ –∫–æ–º–ø–∞–Ω—ñ—è –º–∞—î —Å–≤–æ—ó —Å—Ç–æ–≤–ø—Ü—ñ: `Open`, `High`, `Low`, `Close`, `Volume`, `Adj Close`.

---

## –û–±‚Äô—î–¥–Ω–∞–Ω–Ω—è –≤ —î–¥–∏–Ω–∏–π DataFrame

```
for ticker in tickers:
    df = data[ticker].copy()
    df["Company"] = company_names[ticker]
    formatted_data[ticker] = df
final_df = pd.concat(formatted_data.values())
```

- –î–∞–Ω—ñ –∑ –∫–æ–∂–Ω–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ.
- –î–æ–¥–∞—î—Ç—å—Å—è –∫–æ–ª–æ–Ω–∫–∞ `Company` –∑ –ø–æ–≤–Ω–æ—é –Ω–∞–∑–≤–æ—é –∫–æ–º–ø–∞–Ω—ñ—ó.
- –í—Å—ñ –¥–∞–Ω—ñ –æ–±‚Äô—î–¥–Ω—É—é—Ç—å—Å—è —É —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º.

---

## –§—ñ–Ω–∞–ª—å–Ω–∞ –æ—á–∏—Å—Ç–∫–∞

```
final_df.reset_index(inplace=True)
final_df.rename(columns={"index": "Date"}, inplace=True)
final_df = final_df[["Date","Company","Open","High","Low","Close","Volume"]]
```

- –ü–µ—Ä–µ–Ω–∞–∑–≤–∞–Ω–æ –∫–æ–ª–æ–Ω–∫—É –∑ –¥–∞—Ç–æ—é (`index` ‚Üí `Date`)
- –í–∏–±—Ä–∞–Ω–æ –∫–ª—é—á–æ–≤—ñ –ø–æ–ª—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

---

## –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è

```
final_df.to_csv(filename, index=False, header=header_required)
```

- CSV-—Ñ–∞–π–ª —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑ —ñ–º–µ–Ω–µ–º: `stock_prices_YYYY_MM_DD.csv`
- –ù–∞—è–≤–Ω—ñ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–∏–ø—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
  - –Ü—Å—Ç–æ—Ä–∏—á–Ω–µ ‚Äî `header=True`
  - –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–µ ‚Äî `header=False`

---

## –ë—ñ–∑–Ω–µ—Å-—Ü—ñ–Ω–Ω—ñ—Å—Ç—å

- **–Ü—Å—Ç–æ—Ä–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:** —Ñ–æ—Ä–º—É—î –±–∞–∑–æ–≤—É –±–∞–∑—É –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è, –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏, ML.
- **–Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –¥–∞–Ω—ñ —â–æ–¥–Ω—è –±–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è.
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É CSV —Ä–æ–±–∏—Ç—å –¥–∞–Ω—ñ —Å—É–º—ñ—Å–Ω–∏–º–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ ETL-–ø—Ä–æ—Ü–µ—Å–∞—Ö, Apache Spark, Databricks –∞–±–æ BI-—Å–∏—Å—Ç–µ–º–∞—Ö.
